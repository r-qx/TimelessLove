<view class="task-list-container">
  <view class="tab-header">
    <view class="tab-bar">
      <view class="tab-item {{activeTab === 'in_progress' ? 'active' : ''}}" 
            bindtap="onTabChange" data-name="in_progress">
        <text class="tab-text">è¿›è¡Œä¸­</text>
        <view class="tab-indicator" wx:if="{{activeTab === 'in_progress'}}"></view>
      </view>
      <view class="tab-item {{activeTab === 'pending' ? 'active' : ''}}" 
            bindtap="onTabChange" data-name="pending">
        <text class="tab-text">å¾…ç¡®è®¤</text>
        <view class="tab-indicator" wx:if="{{activeTab === 'pending'}}"></view>
      </view>
      <view class="tab-item {{activeTab === 'completed' ? 'active' : ''}}" 
            bindtap="onTabChange" data-name="completed">
        <text class="tab-text">å·²å®Œæˆ</text>
        <view class="tab-indicator" wx:if="{{activeTab === 'completed'}}"></view>
      </view>
    </view>
  </view>

  <scroll-view 
    class="task-scroll" 
    scroll-y 
    bindscrolltolower="loadMore"
    refresher-enabled
    bindrefresherrefresh="onRefresh"
    refresher-triggered="{{ refreshing }}"
  >
    <view class="task-list">
      <block wx:for="{{tasks}}" wx:key="_id">
        <view class="task-item" bindtap="goToDetail" data-id="{{item._id}}">
          <view class="task-item-top">
            <view class="task-title-row">
              <view class="type-indicator {{item.type}}"></view>
              <text class="task-title">{{item.title}}</text>
            </view>
            <view class="task-type-badge">{{item.typeText}}</view>
          </view>
          <view wx:if="{{item.description}}" class="task-desc">{{item.description}}</view>
          <view class="task-bottom">
            <view class="task-rewards">
              <view class="reward-tag">
                <text>â¤ï¸ +{{item.reward_points}}</text>
              </view>
              <view class="reward-tag gold">
                <text>ğŸ’° +{{item.reward_coins}}</text>
              </view>
            </view>
            <view class="task-meta">
              <text class="difficulty-stars">{{item.difficulty}}â­</text>
              <text class="deadline-text">{{item.deadlineText}}</text>
            </view>
          </view>
        </view>
      </block>
      
      <view wx:if="{{tasks.length === 0 && !loading}}" class="empty-state">
        <text class="empty-icon">ğŸŒ¸</text>
        <text class="empty-text">æš‚æ— ä»»åŠ¡</text>
        <text class="empty-hint">ç‚¹å‡»å³ä¸‹è§’åˆ›å»ºä¸€ä¸ªå§</text>
      </view>
      
      <view wx:if="{{loading}}" class="loading-more">
        <van-loading size="24px" color="#C2185B">åŠ è½½ä¸­...</van-loading>
      </view>
      
      <view wx:if="{{noMore && tasks.length > 0}}" class="no-more">
        <view class="no-more-line"></view>
        <text class="no-more-text">å·²ç»åˆ°åº•å•¦</text>
        <view class="no-more-line"></view>
      </view>
    </view>
  </scroll-view>

  <view class="create-actions">
    <view class="action-btn template-btn" bindtap="goToTemplate">
      <van-icon name="apps-o" size="24px" color="#8B2252" />
      <text>æ¨¡æ¿</text>
    </view>
    <view class="create-fab" bindtap="goToCreate">
      <text class="fab-icon">+</text>
    </view>
  </view>
</view>
